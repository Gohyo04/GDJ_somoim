<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <!-- mapper namespace는 비우면 에러 -->
  <mapper namespace="com.somoim.app.moim.board.BoardDAO">
  
  	<!-- list -->
  	<select id="list" resultType="MoimBoardDTO" parameterType="Map">
  		SELECT *
		FROM (SELECT ROWNUM R, N.*
	 		  FROM (SELECT * FROM MOIMBOARD
	 		  		WHERE MOIMNUM =#{moimDTO.moimNum}
	   		  		ORDER BY BOARDNUM DESC)N)
	   	WHERE R BETWEEN #{pager.startRow} AND #{pager.lastRow}
  	</select>
  	<select id="getTotalCount" resultType="Long" parameterType="MoimDTO">
		SELECT COUNT(BOARDNUM)
		FROM MOIMBOARD
		WHERE MOIMNUM =#{moimNum}
	</select>
  
  
  
  
  	<!-- add -->
  	<insert id="add" parameterType="MoimBoardDTO">
		<selectKey keyProperty="boardNum" resultType="Long" order="BEFORE">
  			SELECT MOIMBOARD_SEQ.NEXTVAL FROM DUAL
  		</selectKey>
		INSERT INTO MOIMBOARD
	  	VALUES(#{boardNum}, #{boardTitle},#{boardText}, current_date, 0, 0, #{userName}, #{moimNum}, #{boardWriter})	
	</insert>
	
	<!-- File Add -->
	<insert id="fileAdd" parameterType="MoimBoardFileDTO">
		INSERT INTO MOIMBOARDFILE
		VALUES
		(MOIMBOARDFILE_SEQ.NEXTVAL, #{boardNum},#{fileName},#{oriName})
	</insert>
  
  
  
  </mapper>